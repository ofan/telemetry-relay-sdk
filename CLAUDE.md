# telemetry-relay-sdk

Lightweight client SDK for [telemetry-relay](https://github.com/ofan/telemetry-relay). Fire-and-forget telemetry from any JS/TS runtime.

## Commands
- `npm test` — run tests (vitest)
- `npm run build` — generate version stub + build ESM/CJS/DTS (tsup)

## Key Files
- `src/index.ts` — createRelay factory, Relay interface, track method
- `src/version.ts` — auto-generated by `scripts/gen-version.sh` (gitignored)
- `test/relay.test.ts` — unit tests (fetch spy, fire-and-forget behavior)
- `scripts/gen-version.sh` — generates version.ts from package.json + git hash

## Architecture
- Single export: `createRelay()` returns a `Relay` with one method: `track()`
- Fire-and-forget: network errors silently swallowed — telemetry never breaks the host app
- Zero dependencies: uses global `fetch` only
- Universal: Node.js 18+, Bun, Deno, browsers

## Release Flow
- release-please on push to main → creates version bump PR
- Merge PR → release-please creates `v*` tag → publish workflow runs
- Publish uses OIDC trusted publishing with `--provenance` (no NPM_TOKEN)
- `RELEASE_PLEASE_TOKEN` secret: PAT for release-please to create PRs/tags

## Conventions
- `src/version.ts` is gitignored — always generated, never committed
- CI generates a stub (`0.0.0-ci`) before tests; build generates real version
- No runtime dependencies — keep it that way
